<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Apresentação Criativa</title>
  <style>
    body, html { margin: 0; padding: 0; overflow: hidden; }
    #canvasContainer { position: relative; width: 100vw; height: 100vh; }
    canvas { background: #ffffff; display: block; }
    #controls {
      position: absolute; top: 10px; left: 10px; z-index: 10;
      background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 8px;
    }
    .btn { margin: 5px; }
    input, select { margin: 5px; }
  </style>
</head>
<body>
  <div id="canvasContainer">
    <canvas id="slideCanvas"></canvas>
    <div id="controls">
      <div>
        <label>Cor:</label><input type="color" id="colorPicker">
        <label>Forma:</label>
        <select id="shapeSelect">
          <option value="circle">Círculo</option>
          <option value="square">Quadrado</option>
          <option value="text">Texto</option>
        </select>
        <input type="text" id="textInput" placeholder="Texto opcional">
        <button class="btn" onclick="drawItem()">Criar</button>
      </div>
      <div>
        <input type="file" id="imgInput" accept="image/*">
        <button class="btn" onclick="addImage()">Adicionar Imagem</button>
      </div>
      <div>
        <label>Fundo:</label><input type="color" id="bgPicker">
        <button class="btn" onclick="changeBackground()">Alterar Fundo</button>
      </div>
      <div>
        <button class="btn" onclick="prevSlide()">⬅️</button>
        <button class="btn" onclick="nextSlide()">➡️</button>
        <button class="btn" onclick="addSlide()">➕ Slide</button>
        <button class="btn" onclick="removeSlide()">➖ Slide</button>
        <button class="btn" onclick="startPresentation()">⛶ Tela Cheia</button>
      </div>
    </div>
  </div>

 <script>
let selectedItem = null;
let offsetX = 0;
let offsetY = 0;

const canvas = document.getElementById("slideCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let slides = [];
let current = 0;
slides.push({ bg: "#ffffff", items: [] });

function drawSlide(index) {
  const slide = slides[index];
  ctx.fillStyle = slide.bg || "#fff";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  slide.items.forEach(item => {
    ctx.fillStyle = item.color;
    if (item.type === "circle") {
      ctx.beginPath();
      ctx.arc(item.x, item.y, 50, 0, 2 * Math.PI);
      ctx.fill();
    } else if (item.type === "square") {
      ctx.fillRect(item.x - 50, item.y - 50, 100, 100);
    } else if (item.type === "text") {
      ctx.font = "30px Arial";
      ctx.fillText(item.text || "Texto", item.x, item.y);
    } else if (item.type === "img") {
      ctx.drawImage(item.img, item.x, item.y, 200, 150);
    }
  });
}

function drawItem() {
  const shape = document.getElementById("shapeSelect").value;
  const color = document.getElementById("colorPicker").value;
  const text = document.getElementById("textInput").value;
  slides[current].items.push({
    type: shape,
    color: color,
    text: text,
    x: 200 + Math.random() * 800,
    y: 200 + Math.random() * 400
  });
  drawSlide(current);
}

function changeBackground() {
  const bg = document.getElementById("bgPicker").value;
  slides[current].bg = bg;
  drawSlide(current);
}

function addImage() {
  const file = document.getElementById("imgInput").files[0];
  if (file) {
    const img = new Image();
    img.onload = function () {
      slides[current].items.push({ type: "img", img: img, x: 300, y: 300 });
      drawSlide(current);
    };
    img.src = URL.createObjectURL(file);
  }
}

function addSlide() {
  slides.push({ bg: "#ffffff", items: [] });
  current = slides.length - 1;
  drawSlide(current);
}

function removeSlide() {
  if (slides.length > 1) {
    slides.splice(current, 1);
    current = Math.max(0, current - 1);
    drawSlide(current);
  }
}

function nextSlide() {
  if (current < slides.length - 1) current++;
  drawSlide(current);
}

function prevSlide() {
  if (current > 0) current--;
  drawSlide(current);
}

function startPresentation() {
  document.documentElement.requestFullscreen();
}

// Mouse events
canvas.addEventListener("mousedown", (e) => {
  const mouseX = e.offsetX;
  const mouseY = e.offsetY;
  selectedItem = null;
  const slide = slides[current];
  for (let i = slide.items.length - 1; i >= 0; i--) {
    const item = slide.items[i];
    if (item.type === "circle") {
      const dx = mouseX - item.x;
      const dy = mouseY - item.y;
      if (Math.sqrt(dx * dx + dy * dy) < 50) {
        selectedItem = item;
        offsetX = dx;
        offsetY = dy;
        break;
      }
    } else if (item.type === "square") {
      if (mouseX >= item.x - 50 && mouseX <= item.x + 50 &&
          mouseY >= item.y - 50 && mouseY <= item.y + 50) {
        selectedItem = item;
        offsetX = mouseX - item.x;
        offsetY = mouseY - item.y;
        break;
      }
    } else if (item.type === "text" || item.type === "img") {
      const w = item.type === "img" ? 200 : 200;
      const h = item.type === "img" ? 150 : 30;
      if (mouseX >= item.x && mouseX <= item.x + w &&
          mouseY >= item.y && mouseY <= item.y + h) {
        selectedItem = item;
        offsetX = mouseX - item.x;
        offsetY = mouseY - item.y;
        break;
      }
    }
  }
});

canvas.addEventListener("mousemove", (e) => {
  if (selectedItem) {
    selectedItem.x = e.offsetX - offsetX;
    selectedItem.y = e.offsetY - offsetY;
    drawSlide(current);
  }
});

canvas.addEventListener("mouseup", () => {
  selectedItem = null;
});

// Touch events
canvas.addEventListener("touchstart", (e) => {
  const touch = e.touches[0];
  const rect = canvas.getBoundingClientRect();
  const x = touch.clientX - rect.left;
  const y = touch.clientY - rect.top;

  selectedItem = null;
  const slide = slides[current];

  for (let i = slide.items.length - 1; i >= 0; i--) {
    const item = slide.items[i];
    if (item.type === "circle") {
      const dx = x - item.x;
      const dy = y - item.y;
      if (Math.sqrt(dx * dx + dy * dy) < 50) {
        selectedItem = item;
        offsetX = dx;
        offsetY = dy;
        break;
      }
    } else if (item.type === "square") {
      if (x >= item.x - 50 && x <= item.x + 50 &&
          y >= item.y - 50 && y <= item.y + 50) {
        selectedItem = item;
        offsetX = x - item.x;
        offsetY = y - item.y;
        break;
      }
    } else if (item.type === "text" || item.type === "img") {
      const w = item.type === "img" ? 200 : 200;
      const h = item.type === "img" ? 150 : 30;
      if (x >= item.x && x <= item.x + w &&
          y >= item.y && y <= item.y + h) {
        selectedItem = item;
        offsetX = x - item.x;
        offsetY = y - item.y;
        break;
      }
    }
  }
}, { passive: false });

canvas.addEventListener("touchmove", (e) => {
  if (selectedItem) {
    e.preventDefault();
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    selectedItem.x = touch.clientX - rect.left - offsetX;
    selectedItem.y = touch.clientY - rect.top - offsetY;
    drawSlide(current);
  }
}, { passive: false });

canvas.addEventListener("touchend", () => {
  selectedItem = null;
});

drawSlide(current);
</script>
</body>
</html>